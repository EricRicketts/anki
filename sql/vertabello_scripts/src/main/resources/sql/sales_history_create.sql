use vertabello_multiple_joins;
create table if not exists sales_history (
    date DATE not null,
    product_id int not null,
    amount int not null,
    foreign key (product_id) references product(id) on delete cascade
);

insert into sales_history(date, product_id, amount)
    values ('2015-01-14', 1, 14),
    ('2015-01-14', 1, 13),
    ('2015-01-15', 2, 2),
    ('2015-01-16', 2, 6),
    ('2015-01-17', 3, 8),
    ('2015-01-18', 6, 5),
    ('2015-01-19', 5, 9),
    ('2015-01-20', 40, 3),
    ('2015-01-21', 21, 5),
    ('2015-01-22', 20, 8),
    ('2015-01-23', 10, 3),
    ('2015-01-24', 6, 1),
    ('2015-01-25', 5, 1),
    ('2015-01-26', 3, 23),
    ('2015-01-27', 2, 32),
    ('2015-01-28', 1, 43),
    ('2015-01-29', 6, 6),
    ('2015-01-30', 7, 8),
    ('2015-01-31', 8, 2),
    ('2015-02-01', 10, 9),
    ('2015-02-02', 11, 7),
    ('2015-02-03', 13, 3),
    ('2015-02-04', 15, 32),
    ('2015-02-05', 16, 1),
    ('2015-02-06', 22, 12),
    ('2015-02-07', 22, 21),
    ('2015-02-02', 12, 11),
    ('2015-02-02', 14, 14),
    ('2015-02-02', 16, 15),
    ('2015-02-04', 18, 16),
    ('2015-02-04', 19, 23),
    ('2015-02-04', 21, 6),
    ('2015-01-16', 20, 2),
    ('2015-01-17', 38, 2),
    ('2015-01-19', 30, 4),
    ('2015-01-20', 27, 5),
    ('2015-01-21', 24, 15);